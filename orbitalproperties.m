function [rho,Tatmos,v,meanRadiusOfEarth,mu,meanMotion,SSOinclination,J2]=orbitalproperties(altitude)
%% orbitalproperties provides physics constants and orbital properties
%% density is the minimum density at solar minimum and winter latitude, minimum density is engineeringing worst case (conservative assumption)

  meanRadiusOfEarth=6371000;          %% [m]
  %equatorialRadiusOfEarth=6378.1;     %% [m]
  %polarRadiusOfEarth=6356.8;          %% [m] 
  J2=0.00108263; %%%%%%%%%%%TO BE CHECKED
  mu=3.986004418E14;                  %% [m3?s?2] gravitational constant
  rhoarray=[    300	6.64E-15
                    310	5.02E-15
                    320	3.82E-15
                    330	2.93E-15
                    340	2.26E-15
                    350	1.75E-15
                    360	1.36E-15
                    370	1.07E-15
                    380	8.37E-16
                    390	6.60E-16
                    400	5.22E-16
                    410	4.14E-16
                    420	3.29E-16
                    430	2.62E-16
                    440	2.10E-16
                    450	1.68E-16
                    460	1.35E-16
                    470	1.08E-16
                    480	8.72E-17
                    490	7.04E-17
                    500	5.70E-17
                    510	4.62E-17
                    520	3.76E-17
                    530	3.06E-17
                    540	2.50E-17
                    550	2.05E-17
                    560	1.68E-17
                    570	1.39E-17
                    580	1.15E-17
                    590	9.55E-18
                    600	7.97E-18
                    610	6.69E-18
                    620	5.64E-18
                    630	4.78E-18
                    640	4.08E-18
                    650	3.50E-18
                    660	3.03E-18
                    670	2.63E-18
                    680	2.31E-18
                    690	2.04E-18
                    700	1.81E-18
                    710	1.62E-18
                    720	1.46E-18
                    730	1.32E-18
                    740	1.21E-18
                    750	1.11E-18
                    760	1.02E-18
                    770	9.49E-19
                    780	8.84E-19
                    790	8.28E-19
                    800	7.78E-19
                    810	7.34E-19
                    820	6.95E-19
                    830	6.60E-19
                    840	6.28E-19
                    850	5.99E-19
                    860	5.72E-19
                    870	5.48E-19
                    880	5.25E-19
                    890	5.05E-19
                    900	4.85E-19
                    910	4.67E-19
                    920	4.51E-19
                    930	4.35E-19
                    940	4.20E-19
                    950	4.06E-19
                    960	3.93E-19
                    970	3.80E-19
                    980	3.68E-19
                    990	3.57E-19
                    1000	3.46E-19];
  rhoarray(:,1)=rhoarray(:,1)*1000;         %from km to m
  rhoarray(:,2)=rhoarray(:,2)/1000*100^3;   %from g/cm3 to kg/m3
  f=fit(rhoarray(:,1),rhoarray(:,2),'exp1');
  rho=f(altitude);
  Tatmos      =900;                           %% this should be interpolated later [K]
  r0=meanRadiusOfEarth+altitude;              %% [m]
  v=sqrt(mu/r0);
  meanMotion=sqrt(mu/r0^3);                   %% mean motion [rad/s]
  sma=(1/meanMotion^2*mu)^(1/3);
  SSOinclination=acosd(-(sma/12352000)^(7/2));%% [deg]
end

%{ 
https://ccmc.gsfc.nasa.gov/cgi-bin/modelweb/models/vitmo_model.cgi

ModelWeb	Browser	Results						
								
nrlmsise	model	listing						
Required	input	parameters						
Year=	1996,	Month=	1,	Day=	1,	Hour=	1.50,	
Time_type	=	Universal						
Coordinate_type	=	Geographic						
Latitude=	-60.00,	Longitude=	0.00,	Height=	100			
Prof.	parameters:	Start=	300	Stop=	1000	Step=	10	
								
Optional	input	parameters:						
								
Sunspot	number(Rz12)	#NAME?	specified					
Ionospheric	index(IG12)	#NAME?	specified					
Upper	limit	for	Electron	content	=	not	specified	
F	peak	model	=					
Ne	Topside	=						
foF2	Storm	model	=					
Bottomside	Thickness	=						
F1	occurrence	probability	=					
D-Region	Ne	=						
Topside	Te	=						
Ion	Composition	=						
								
Selected	output	parameters:						
1	Height,	km						
2	O,	cm-3						
3	N2,	cm-3						
4	O2,	cm-3						
5	Mass_density,	g/cm-3						
6	He,	cm-3						
7	H,	cm-3						
8	N,	cm-3						
								
1	2	3	4	5	6	7	8	
	300	1.70E+08	4.28E+07	1.60E+06	6.64E-15	9.67E+05	2.58E+05	1.44E+06
	310	1.36E+08	2.87E+07	1.01E+06	5.02E-15	9.14E+05	2.54E+05	1.17E+06
	320	1.08E+08	1.93E+07	6.41E+05	3.82E-15	8.63E+05	2.51E+05	9.56E+05
	330	8.59E+07	1.29E+07	4.07E+05	2.93E-15	8.15E+05	2.47E+05	7.80E+05
	340	6.85E+07	8.70E+06	2.59E+05	2.26E-15	7.70E+05	2.43E+05	6.37E+05
	350	5.47E+07	5.86E+06	1.65E+05	1.75E-15	7.28E+05	2.40E+05	5.21E+05
	360	4.36E+07	3.95E+06	1.05E+05	1.36E-15	6.88E+05	2.37E+05	4.27E+05
	370	3.49E+07	2.67E+06	6.70E+04	1.07E-15	6.50E+05	2.33E+05	3.50E+05
	380	2.79E+07	1.80E+06	4.28E+04	8.37E-16	6.15E+05	2.30E+05	2.87E+05
	390	2.23E+07	1.22E+06	2.74E+04	6.60E-16	5.82E+05	2.27E+05	2.36E+05
	400	1.78E+07	8.26E+05	1.76E+04	5.22E-16	5.50E+05	2.24E+05	1.94E+05
	410	1.43E+07	5.60E+05	1.13E+04	4.14E-16	5.21E+05	2.21E+05	1.59E+05
	420	1.15E+07	3.81E+05	7.24E+03	3.29E-16	4.93E+05	2.18E+05	1.31E+05
	430	9.19E+06	2.59E+05	4.66E+03	2.62E-16	4.66E+05	2.15E+05	1.08E+05
	440	7.37E+06	1.76E+05	3.00E+03	2.10E-16	4.41E+05	2.12E+05	8.92E+04
	450	5.92E+06	1.20E+05	1.94E+03	1.68E-16	4.18E+05	2.09E+05	7.36E+04
	460	4.76E+06	8.18E+04	1.25E+03	1.35E-16	3.95E+05	2.06E+05	6.07E+04
	470	3.83E+06	5.59E+04	8.08E+02	1.08E-16	3.74E+05	2.03E+05	5.01E+04
	480	3.08E+06	3.82E+04	5.23E+02	8.72E-17	3.55E+05	2.00E+05	4.15E+04
	490	2.48E+06	2.61E+04	3.39E+02	7.04E-17	3.36E+05	1.98E+05	3.43E+04
	500	2.00E+06	1.79E+04	2.20E+02	5.70E-17	3.18E+05	1.95E+05	2.84E+04
	510	1.61E+06	1.23E+04	1.43E+02	4.62E-17	3.02E+05	1.93E+05	2.35E+04
	520	1.30E+06	8.43E+03	9.31E+01	3.76E-17	2.86E+05	1.90E+05	1.95E+04
	530	1.05E+06	5.80E+03	6.07E+01	3.06E-17	2.71E+05	1.87E+05	1.62E+04
	540	8.47E+05	3.99E+03	3.96E+01	2.50E-17	2.57E+05	1.85E+05	1.34E+04
	550	6.84E+05	2.75E+03	2.59E+01	2.05E-17	2.44E+05	1.83E+05	1.11E+04
	560	5.53E+05	1.89E+03	1.69E+01	1.68E-17	2.31E+05	1.80E+05	9.23E+03
	570	4.48E+05	1.31E+03	1.11E+01	1.39E-17	2.19E+05	1.78E+05	7.67E+03
	580	3.63E+05	9.04E+02	7.26E+00	1.15E-17	2.08E+05	1.75E+05	6.38E+03
	590	2.94E+05	6.25E+02	4.76E+00	9.55E-18	1.97E+05	1.73E+05	5.30E+03
	600	2.38E+05	4.33E+02	3.13E+00	7.97E-18	1.87E+05	1.71E+05	4.41E+03
	610	1.93E+05	3.00E+02	2.06E+00	6.69E-18	1.78E+05	1.69E+05	3.68E+03
	620	1.57E+05	2.08E+02	1.36E+00	5.64E-18	1.68E+05	1.66E+05	3.06E+03
	630	1.27E+05	1.45E+02	8.95E-01	4.78E-18	1.60E+05	1.64E+05	2.55E+03
	640	1.03E+05	1.01E+02	5.91E-01	4.08E-18	1.52E+05	1.62E+05	2.13E+03
	650	8.41E+04	7.01E+01	3.90E-01	3.50E-18	1.44E+05	1.60E+05	1.78E+03
	660	6.84E+04	4.88E+01	2.58E-01	3.03E-18	1.37E+05	1.58E+05	1.48E+03
	670	5.57E+04	3.41E+01	1.71E-01	2.63E-18	1.30E+05	1.56E+05	1.24E+03
	680	4.54E+04	2.38E+01	1.14E-01	2.31E-18	1.24E+05	1.54E+05	1.04E+03
	690	3.70E+04	1.66E+01	7.55E-02	2.04E-18	1.17E+05	1.52E+05	8.65E+02
	700	3.02E+04	1.16E+01	5.02E-02	1.81E-18	1.12E+05	1.50E+05	7.24E+02
	710	2.46E+04	8.15E+00	3.34E-02	1.62E-18	1.06E+05	1.48E+05	6.06E+02
	720	2.01E+04	5.72E+00	2.23E-02	1.46E-18	1.01E+05	1.46E+05	5.07E+02
	730	1.64E+04	4.01E+00	1.49E-02	1.32E-18	9.58E+04	1.45E+05	4.25E+02
	740	1.34E+04	2.82E+00	9.92E-03	1.21E-18	9.11E+04	1.43E+05	3.56E+02
	750	1.10E+04	1.98E+00	6.64E-03	1.11E-18	8.66E+04	1.41E+05	2.99E+02
	760	8.97E+03	1.40E+00	4.44E-03	1.02E-18	8.24E+04	1.39E+05	2.51E+02
	770	7.34E+03	9.83E-01	2.98E-03	9.49E-19	7.84E+04	1.37E+05	2.10E+02
	780	6.02E+03	6.93E-01	2.00E-03	8.84E-19	7.46E+04	1.36E+05	1.77E+02
	790	4.93E+03	4.90E-01	1.34E-03	8.28E-19	7.09E+04	1.34E+05	1.48E+02
	800	4.04E+03	3.46E-01	9.03E-04	7.78E-19	6.75E+04	1.32E+05	1.25E+02
	810	3.32E+03	2.45E-01	6.08E-04	7.34E-19	6.43E+04	1.31E+05	1.05E+02
	820	2.72E+03	1.73E-01	4.10E-04	6.95E-19	6.12E+04	1.29E+05	8.83E+01
	830	2.24E+03	1.23E-01	2.76E-04	6.60E-19	5.82E+04	1.28E+05	7.43E+01
	840	1.84E+03	8.71E-02	1.87E-04	6.28E-19	5.54E+04	1.26E+05	6.26E+01
	850	1.51E+03	6.19E-02	1.26E-04	5.99E-19	5.28E+04	1.25E+05	5.28E+01
	860	1.24E+03	4.40E-02	8.55E-05	5.72E-19	5.03E+04	1.23E+05	4.45E+01
	870	1.02E+03	3.13E-02	5.79E-05	5.48E-19	4.79E+04	1.22E+05	3.75E+01
	880	8.44E+02	2.23E-02	3.93E-05	5.25E-19	4.56E+04	1.20E+05	3.17E+01
	890	6.95E+02	1.59E-02	2.67E-05	5.05E-19	4.35E+04	1.19E+05	2.67E+01
	900	5.73E+02	1.13E-02	1.81E-05	4.85E-19	4.14E+04	1.17E+05	2.26E+01
	910	4.73E+02	8.09E-03	1.23E-05	4.67E-19	3.95E+04	1.16E+05	1.91E+01
	920	3.90E+02	5.78E-03	8.41E-06	4.51E-19	3.76E+04	1.14E+05	1.61E+01
	930	3.22E+02	4.14E-03	5.74E-06	4.35E-19	3.59E+04	1.13E+05	1.36E+01
	940	2.66E+02	2.96E-03	3.92E-06	4.20E-19	3.42E+04	1.12E+05	1.16E+01
	950	2.20E+02	2.12E-03	2.68E-06	4.06E-19	3.26E+04	1.10E+05	9.77E+00
	960	1.82E+02	1.52E-03	1.83E-06	3.93E-19	3.11E+04	1.09E+05	8.28E+00
	970	1.51E+02	1.09E-03	1.25E-06	3.80E-19	2.97E+04	1.08E+05	7.02E+00
	980	1.25E+02	7.86E-04	8.60E-07	3.68E-19	2.83E+04	1.07E+05	5.95E+00
	990	1.03E+02	5.65E-04	5.90E-07	3.57E-19	2.70E+04	1.05E+05	5.04E+00
	1000	8.57E+01	4.07E-04	4.05E-07	3.46E-19	2.58E+04	1.04E+05	4.28E+00
%}